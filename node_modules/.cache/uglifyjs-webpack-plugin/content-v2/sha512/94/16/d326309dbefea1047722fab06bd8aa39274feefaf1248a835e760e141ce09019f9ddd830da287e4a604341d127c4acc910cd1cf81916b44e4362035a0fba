{"code":"!function(t){var e={};function a(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,o){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},a.r=function(t){\"undefined\"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&\"object\"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var n in t)a.d(o,n,function(e){return t[e]}.bind(null,n));return o},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,\"a\",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p=\"/\",a(a.s=11)}([function(t,e,a){\"use strict\";e.__esModule=!0;var o,n=a(26),s=(o=n)&&o.__esModule?o:{default:o};e.default=s.default||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o])}return t}},function(t,e){var a=t.exports=\"undefined\"!=typeof window&&window.Math==Math?window:\"undefined\"!=typeof self&&self.Math==Math?self:Function(\"return this\")();\"number\"==typeof __g&&(__g=a)},function(t,e){var a=t.exports={version:\"2.6.5\"};\"number\"==typeof __e&&(__e=a)},function(t,e){t.exports=function(t){return\"object\"===typeof t?null!==t:\"function\"===typeof t}},function(t,e,a){t.exports=!a(5)(function(){return 7!=Object.defineProperty({},\"a\",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){var a={}.hasOwnProperty;t.exports=function(t,e){return a.call(t,e)}},function(t,e,a){var o=a(8),n=a(9);t.exports=function(t){return o(n(t))}},function(t,e,a){var o=a(42);t.exports=Object(\"z\").propertyIsEnumerable(0)?Object:function(t){return\"String\"==o(t)?t.split(\"\"):Object(t)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError(\"Can't call method on  \"+t);return t}},function(t,e){var a=Math.ceil,o=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?o:a)(t)}},function(t,e,a){t.exports=a(12)},function(module,exports,__webpack_require__){\"use strict\";\n/*BUGME_START*/var __BUGME_START__=1;!function(){var CircularJSON=JSON,replacer=function(t,e){return void 0===e?\"\\xa9undefined\":null===e?\"\\xa9null\":e===-1/0?\"\\xa9- Infinity\":e===1/0?\"\\xa9Infinity\":\"number\"==typeof e&&isNaN(e)?\"\\xa9NaN\":\"function\"==typeof e?\"\\xa9function\":e};try{CircularJSON=eval('(function(JSON,RegExp){var specialChar=\"~\",safeSpecialChar=\"\\\\\\\\x\"+(\"0\"+specialChar.charCodeAt(0).toString(16)).slice(-2),escapedSafeSpecialChar=\"\\\\\\\\\"+safeSpecialChar,specialCharRG=new RegExp(safeSpecialChar,\"g\"),safeSpecialCharRG=new RegExp(escapedSafeSpecialChar,\"g\"),safeStartWithSpecialCharRG=new RegExp(\"(?:^|([^\\\\\\\\\\\\\\\\]))\"+escapedSafeSpecialChar),indexOf=[].indexOf||function(v){for(var i=this.length;i--&&this[i]!==v;);return i},$String=String;function generateReplacer(value,replacer,resolve){var doNotIgnore=false,inspect=!!replacer,path=[],all=[value],seen=[value],mapp=[resolve?specialChar:\"[Circular]\"],last=value,lvl=1,i,fn;if(inspect){fn=typeof replacer===\"object\"?function(key,value){return key!==\"\"&&replacer.indexOf(key)<0?void 0:value}:replacer}return function(key,value){if(inspect)value=fn.call(this,key,value);if(doNotIgnore){if(last!==this){i=lvl-indexOf.call(all,this)-1;lvl-=i;all.splice(lvl,all.length);path.splice(lvl-1,path.length);last=this}if(typeof value===\"object\"&&value){if(indexOf.call(all,value)<0){all.push(last=value)}lvl=all.length;i=indexOf.call(seen,value);if(i<0){i=seen.push(value)-1;if(resolve){path.push((\"\"+key).replace(specialCharRG,safeSpecialChar));mapp[i]=specialChar+path.join(specialChar)}else{mapp[i]=mapp[0]}}else{value=mapp[i]}}else{if(typeof value===\"string\"&&resolve){value=value.replace(safeSpecialChar,escapedSafeSpecialChar).replace(specialChar,safeSpecialChar)}}}else{doNotIgnore=true}return value}}function retrieveFromPath(current,keys){for(var i=0,length=keys.length;i<length;current=current[keys[i++].replace(safeSpecialCharRG,specialChar)]);return current}function generateReviver(reviver){return function(key,value){var isString=typeof value===\"string\";if(isString&&value.charAt(0)===specialChar){return new $String(value.slice(1))}if(key===\"\")value=regenerate(value,value,{});if(isString)value=value.replace(safeStartWithSpecialCharRG,\"$1\"+specialChar).replace(escapedSafeSpecialChar,safeSpecialChar);return reviver?reviver.call(this,key,value):value}}function regenerateArray(root,current,retrieve){for(var i=0,length=current.length;i<length;i++){current[i]=regenerate(root,current[i],retrieve)}return current}function regenerateObject(root,current,retrieve){for(var key in current){if(current.hasOwnProperty(key)){current[key]=regenerate(root,current[key],retrieve)}}return current}function regenerate(root,current,retrieve){return current instanceof Array?regenerateArray(root,current,retrieve):current instanceof $String?current.length?retrieve.hasOwnProperty(current)?retrieve[current]:retrieve[current]=retrieveFromPath(root,current.split(specialChar)):root:current instanceof Object?regenerateObject(root,current,retrieve):current}var CircularJSON={stringify:function stringify(value,replacer,space,doNotResolve){return CircularJSON.parser.stringify(value,generateReplacer(value,replacer,!doNotResolve),space)},parse:function parse(text,reviver){return CircularJSON.parser.parse(text,generateReviver(reviver))},parser:JSON};return CircularJSON})(JSON,RegExp)')}catch(t){console.error(t)}var OriginalFunction=Function,OriginalFetch=self.fetch,OriginalBridgeCall=self.AlipayJSBridge&&self.AlipayJSBridge.call,callInternalAPI=function(t,e){var a={data:{method:t,param:e},action:\"internalAPI\"},o=encodeURIComponent(JSON.stringify(a));OriginalFetch?OriginalFetch(\"https://alipay.kylinBridge/?data=\"+o,{mode:\"no-cors\"}).then(function(){}).catch(function(){}):OriginalBridgeCall(\"internalAPI\",{method:t,param:e})},eventHandler=function(t){try{if(t.fromVConsoleToWorker){var e=t.requestId;if(\"exec\"===t.method)try{new OriginalFunction(\"requestId\",\"sendBack\",\"\\n              const res = \"+t.script+\";\\n              console.log(res);\\n            \")(e,function(t){return callInternalAPI(\"tinyDebugConsole\",{type:\"msgFromWorkerToVConsole\",content:CircularJSON.stringify({requestId:e,returnValue:t},replacer)})})}catch(t){console.error(t.name+\":\"+t.message)}}}catch(t){}};setTimeout(function(){self.document&&self.document.addEventListener(\"push\",function(t){try{eventHandler(JSON.parse(t.data.param.content))}catch(t){}}),self.addEventListener(\"push\",function(t){try{var e=JSON.parse(JSON.parse(t.data.text()).param.data.content);eventHandler(e)}catch(t){}})},10),[\"log\",\"info\",\"error\",\"debug\",\"warn\"].forEach(function(t){var e=\"o\"+t;console[e]||(console[e]=console[t],console[t]=function(){for(var a,o=arguments.length,n=Array(o),s=0;s<o;s++)n[s]=arguments[s];(a=console)[e].apply(a,n);var i=void 0;try{i=CircularJSON.stringify(n.map(function(t){return t instanceof Error?t.name+\": \"+t.message:t}),replacer)}catch(t){return void console.error(t.name+\": \"+t.message)}callInternalAPI(\"tinyDebugConsole\",{content:i,type:\"console_\"+t})})})}();var __BUGME_END__=1;\n/*BUGME_END*/if(!self.__appxInited){var success=function(){__webpack_require__(13),__webpack_require__(15),__webpack_require__(16),__webpack_require__(17),__webpack_require__(18),__webpack_require__(19),__webpack_require__(20),__webpack_require__(21),__webpack_require__(22),__webpack_require__(23),__webpack_require__(24),__webpack_require__(25),__webpack_require__(54),__webpack_require__(55),__webpack_require__(56),__webpack_require__(57),__webpack_require__(58),__webpack_require__(59),__webpack_require__(60),__webpack_require__(61),__webpack_require__(62),__webpack_require__(63),__webpack_require__(64),__webpack_require__(65),__webpack_require__(66),__webpack_require__(67),__webpack_require__(68),__webpack_require__(69),__webpack_require__(70)};self.__appxInited=1,__webpack_require__(71),__webpack_require__(73);var AFAppX=self.AFAppX;self.getCurrentPages=AFAppX.getCurrentPages,self.getApp=AFAppX.getApp,self.Page=AFAppX.Page,self.App=AFAppX.App,self.my=AFAppX.bridge||AFAppX.abridge,self.abridge=self.my,self.Component=AFAppX.WorkerComponent||function(){},self.$global=AFAppX.$global,self.bootstrapApp?self.bootstrapApp({success:success}):success()}},function(t,e,a){\"use strict\";var o=a(14);App({onLaunch:function(t){this.globalData.corpId=t.query.corpId,console.log(t.query.corpId),this.login()},onShow:function(t){},globalData:{corpId:\"\",baseUrl:o.url,user:null},login:function(){var t=this;dd.getAuthCode({success:function(e){var a=e.authCode;dd.httpRequest({url:o.url+\"/login/app\",data:{authCode:a},method:\"POST\",success:function(e){if(0===e.data.code){var a=e.data.data;t.globalData.user={userId:a.user.userId,deptId:a.user.deptId},dd.setStorage({key:\"userInfo\",data:{user:a.user,roleAndPermission:a.roleAndPermission,token:a.token}})}}})},fail:function(t){dd.alert({content:JSON.stringify(t)})}})}})},function(t,e,a){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});e.default={url:\"http://106.14.99.110:8080\"},t.exports=e.default},function(t,e){$global.currentComponentConfig={is:\"/node_modules/mini-ddui/es/grid/index\",usingComponents:{}},Component({data:{bottomIndex:0},props:{columnNum:3,circular:!1,list:[],onGridItemClick:function(){},hasLine:!0},didMount:function(){var t=this.props,e=t.list,a=t.columnNum,o=e.length/a;this.setData({bottomIndex:Math.floor(o)===o?(o-1)*a:Math.floor(o)*a})},methods:{onGridItemClick:function(t){this.props.onGridItemClick({detail:{index:t.target.dataset.index}})}}})},function(t,e,a){\"use strict\";$global.currentComponentConfig={is:\"/components/scan/scan\",usingComponents:{}},Component({mixins:[],data:{code:\"\"},props:{onScan:function(t){console.log(\"===scan\\u7ec4\\u4ef6\\u672a\\u4f20\\u5165onScan\\u4e8b\\u4ef6===\")}},didMount:function(){},didUpdate:function(){},didUnmount:function(){},methods:{onTapScan:function(){var t=this;dd.scan({success:function(e){t.setData({code:e.code}),t.props.onScan(e.code)}})}}})},function(t,e){$global.currentComponentConfig={is:\"/node_modules/mini-ddui/es/list/index\",usingComponents:{}},Component({props:{className:\"\"}})},function(t,e){$global.currentComponentConfig={is:\"/node_modules/mini-ddui/es/list/list-item/index\",usingComponents:{}},Component({props:{className:\"\",align:!1,disabled:!1,multipleLine:!1,wrap:!1},methods:{onItemTap:function(t){var e=this.props,a=e.onClick,o=e.disabled;a&&!o&&a({index:t.target.dataset.index})}}})},function(t,e,a){\"use strict\";$global.currentPageConfig={pagePath:\"pages/main/index/index\",usingComponents:{grid:\"/node_modules/mini-ddui/es/grid/index\"},tabIndex:10};getApp().globalData;Page({data:{pageList:[{icon:\"/images/icon/main/inspection.png\",text:\"\\u68c0\\u9a8c\\u8f66\\u95f4\",path:\"/pages/main/inspection/index/index\"},{icon:\"/images/icon/main/produce.png\",text:\"\\u7ec4\\u88c5\\u8f66\\u95f4\",path:\"/pages/main/produce/index/index\"},{icon:\"/images/icon/main/stock.png\",text:\"\\u4ed3\\u5e93\\u7ba1\\u7406\",path:\"/pages/main/stock/index/index\"}]},onLoad:function(){},onGridItemTap:function(t){var e=t.detail.index;dd.navigateTo({url:this.data.pageList[e].path})}})},function(t,e,a){\"use strict\";$global.currentPageConfig={pagePath:\"pages/more/index/index\",usingComponents:{},tabIndex:11},Page({data:{},onLoad:function(){}})},function(t,e,a){\"use strict\";$global.currentPageConfig={pagePath:\"pages/main/inspection/index/index\",usingComponents:{grid:\"/node_modules/mini-ddui/es/grid/index\"}},Page({data:{pageList:[{icon:\"/images/icon/main_inspection/parts-inspection.png\",text:\"\\u6765\\u6599\\u68c0\\u9a8c\",path:\"/pages/main/inspection/partsInspection/index/index\"},{icon:\"/images/icon/main_inspection/component-inspection.png\",text:\"\\u7ec4\\u4ef6\\u68c0\\u9a8c\",path:\"/pages/main/inspection/componentInspectionApprove/index/index\"},{icon:\"/images/icon/main_inspection/product_inspection_approve.png\",text:\"\\u4ea7\\u54c1\\u68c0\\u9a8c\",path:\"/pages/main/inspection/productInspection/productInspection\"}]},onLoad:function(){},onGridItemTap:function(t){var e=t.detail.index;dd.navigateTo({url:this.data.pageList[e].path})}})},function(t,e,a){\"use strict\";$global.currentPageConfig={pagePath:\"pages/main/produce/index/index\",usingComponents:{grid:\"/node_modules/mini-ddui/es/grid/index\"}},Page({data:{pageList:[{icon:\"/images/icon/main_produce/defend.png\",text:\"\\u4e09\\u9632\\u5ba1\\u6279\",path:\"/pages/main/produce/defendApprove/defendApprove\"},{icon:\"/images/icon/main_produce/soft_install.png\",text:\"\\u8f6f\\u4ef6\\u704c\\u88c5\\u53ca\\u8bbe\\u5907\\u6821\\u51c6\",path:\"/pages/main/produce/softInstallApprove/softInstallApprove\"},{icon:\"/images/icon/main_produce/function_inspection.png\",text:\"\\u90e8\\u4ef6\\u529f\\u80fd\\u68c0\\u6d4b\",path:\"/pages/main/produce/functionInspectionApprove/functionInspectionApprove\"},{icon:\"/images/icon/main_produce/component_produce.png\",text:\"\\u7ec4\\u4ef6\\u88c5\\u914d\",path:\"/pages/main/produce/componentProduce/componentProduce\"},{icon:\"/images/icon/main_produce/component_produce_approve.png\",text:\"\\u7ec4\\u4ef6\\u88c5\\u914d\\u5ba1\\u6279\",path:\"/pages/main/produce/componentProduceApprove/componentProduceApprove\"},{icon:\"/images/icon/main_produce/product_produce.png\",text:\"\\u4ea7\\u54c1\\u88c5\\u914d\",path:\"/pages/main/produce/productProduce/productProduce\"},{icon:\"/images/icon/main_produce/product_produce_approve.png\",text:\"\\u4ea7\\u54c1\\u88c5\\u914d\\u5ba1\\u6279\",path:\"/pages/main/produce/productProduceApprove/productProduceApprove\"}]},onLoad:function(){},onGridItemTap:function(t){var e=t.detail.index;dd.navigateTo({url:this.data.pageList[e].path})}})},function(t,e,a){\"use strict\";$global.currentPageConfig={pagePath:\"pages/main/purchase/index/index\",usingComponents:{}},Page({data:{},onLoad:function(){}})},function(t,e,a){\"use strict\";$global.currentPageConfig={pagePath:\"pages/main/stock/index/index\",usingComponents:{grid:\"/node_modules/mini-ddui/es/grid/index\"}},Page({data:{pageList:[{icon:\"/images/icon/main_produce/defend.png\",text:\"\\u90e8\\u4ef6\\u5165\\u5e93\",path:\"/pages/main/stock/stockInParts/stockInParts\"},{icon:\"/images/icon/main_produce/soft_install.png\",text:\"\\u7ec4\\u4ef6\\u5165\\u5e93\",path:\"/pages/main/stock/stockInComponent/stockInComponent\"},{icon:\"/images/icon/main_produce/function_inspection.png\",text:\"\\u4ea7\\u54c1\\u5165\\u5e93\",path:\"/pages/main/stock/stockInProduct/stockInProduct\"},{icon:\"/images/icon/main_produce/component_produce.png\",text:\"\\u90e8\\u4ef6\\u51fa\\u5e93\",path:\"/pages/main/stock/stockOutParts/stockOutParts\"},{icon:\"/images/icon/main_produce/component_produce_approve.png\",text:\"\\u7ec4\\u4ef6\\u51fa\\u5e93\",path:\"/pages/main/stock/stockOutComponent/stockOutComponent\"},{icon:\"/images/icon/main_produce/product_produce.png\",text:\"\\u4ea7\\u54c1\\u53d1\\u8d27\",path:\"/pages/main/stock/stockOutProduct/stockOutProduct\"}]},onLoad:function(){},onGridItemTap:function(t){var e=t.detail.index;dd.navigateTo({url:this.data.pageList[e].path})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/inspection/componentInspectionApprove/index/index\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsCodes:[],goodsItems:[],number:0,componentList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1,componentStatus:!0},onLoad:function(){this.loadComponentList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],goodsCodes:[],goodsItems:[]})},loadComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/unInspection/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({componentList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.componentList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u88c5\\u914d\\u7684\\u7ec4\\u4ef6\"});a.push(t);var s={name:n.name,code:t};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},componentStatusOnChange:function(t){this.setData({componentStatus:t.detail.value})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.componentStatus;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7ec4\\u4ef6\"}),null;var c={componentName:r[0].name,codes:o.join(\",\"),number:n,status:d?0:1,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),s.length>0){var u=i.baseUrl+\"/api/file/upload/app\",l=s,p=c;this.uploadImage({url:u,filePath:l,options:p})}else this.componentInspectionApprove(c)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.componentInspectionApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},componentInspectionApprove:function(t){var e=i.baseUrl+\"/api/produceComponent/inspectionApprove\",a=this;dd.httpRequest({url:e,method:\"POST\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},data:(0,s.default)({},t),success:function(t){0===t.data.code?dd.showToast({content:\"\\u7ec4\\u4ef6\\u68c0\\u9a8c\\u5ba1\\u6279\\u53d1\\u9001\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){a.setData({loading:!1})}})}})},function(t,e,a){t.exports={default:a(27),__esModule:!0}},function(t,e,a){a(28),t.exports=a(2).Object.assign},function(t,e,a){var o=a(29);o(o.S+o.F,\"Object\",{assign:a(39)})},function(t,e,a){var o=a(1),n=a(2),s=a(30),i=a(32),r=a(6),d=function(t,e,a){var c,u,l,p=t&d.F,g=t&d.G,m=t&d.S,h=t&d.P,f=t&d.B,v=t&d.W,P=g?n:n[e]||(n[e]={}),I=P.prototype,k=g?o:m?o[e]:(o[e]||{}).prototype;for(c in g&&(a=e),a)(u=!p&&k&&void 0!==k[c])&&r(P,c)||(l=u?k[c]:a[c],P[c]=g&&\"function\"!=typeof k[c]?a[c]:f&&u?s(l,o):v&&k[c]==l?function(t){var e=function(e,a,o){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,a)}return new t(e,a,o)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):h&&\"function\"==typeof l?s(Function.call,l):l,h&&((P.virtual||(P.virtual={}))[c]=l,t&d.R&&I&&!I[c]&&i(I,c,l)))};d.F=1,d.G=2,d.S=4,d.P=8,d.B=16,d.W=32,d.U=64,d.R=128,t.exports=d},function(t,e,a){var o=a(31);t.exports=function(t,e,a){if(o(t),void 0===e)return t;switch(a){case 1:return function(a){return t.call(e,a)};case 2:return function(a,o){return t.call(e,a,o)};case 3:return function(a,o,n){return t.call(e,a,o,n)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if(\"function\"!=typeof t)throw TypeError(t+\" is not a function!\");return t}},function(t,e,a){var o=a(33),n=a(38);t.exports=a(4)?function(t,e,a){return o.f(t,e,n(1,a))}:function(t,e,a){return t[e]=a,t}},function(t,e,a){var o=a(34),n=a(35),s=a(37),i=Object.defineProperty;e.f=a(4)?Object.defineProperty:function(t,e,a){if(o(t),e=s(e,!0),o(a),n)try{return i(t,e,a)}catch(t){}if(\"get\"in a||\"set\"in a)throw TypeError(\"Accessors not supported!\");return\"value\"in a&&(t[e]=a.value),t}},function(t,e,a){var o=a(3);t.exports=function(t){if(!o(t))throw TypeError(t+\" is not an object!\");return t}},function(t,e,a){t.exports=!a(4)&&!a(5)(function(){return 7!=Object.defineProperty(a(36)(\"div\"),\"a\",{get:function(){return 7}}).a})},function(t,e,a){var o=a(3),n=a(1).document,s=o(n)&&o(n.createElement);t.exports=function(t){return s?n.createElement(t):{}}},function(t,e,a){var o=a(3);t.exports=function(t,e){if(!o(t))return t;var a,n;if(e&&\"function\"==typeof(a=t.toString)&&!o(n=a.call(t)))return n;if(\"function\"==typeof(a=t.valueOf)&&!o(n=a.call(t)))return n;if(!e&&\"function\"==typeof(a=t.toString)&&!o(n=a.call(t)))return n;throw TypeError(\"Can't convert object to primitive value\")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,a){\"use strict\";var o=a(40),n=a(51),s=a(52),i=a(53),r=a(8),d=Object.assign;t.exports=!d||a(5)(function(){var t={},e={},a=Symbol(),o=\"abcdefghijklmnopqrst\";return t[a]=7,o.split(\"\").forEach(function(t){e[t]=t}),7!=d({},t)[a]||Object.keys(d({},e)).join(\"\")!=o})?function(t,e){for(var a=i(t),d=arguments.length,c=1,u=n.f,l=s.f;d>c;)for(var p,g=r(arguments[c++]),m=u?o(g).concat(u(g)):o(g),h=m.length,f=0;h>f;)l.call(g,p=m[f++])&&(a[p]=g[p]);return a}:d},function(t,e,a){var o=a(41),n=a(50);t.exports=Object.keys||function(t){return o(t,n)}},function(t,e,a){var o=a(6),n=a(7),s=a(43)(!1),i=a(46)(\"IE_PROTO\");t.exports=function(t,e){var a,r=n(t),d=0,c=[];for(a in r)a!=i&&o(r,a)&&c.push(a);for(;e.length>d;)o(r,a=e[d++])&&(~s(c,a)||c.push(a));return c}},function(t,e){var a={}.toString;t.exports=function(t){return a.call(t).slice(8,-1)}},function(t,e,a){var o=a(7),n=a(44),s=a(45);t.exports=function(t){return function(e,a,i){var r,d=o(e),c=n(d.length),u=s(i,c);if(t&&a!=a){for(;c>u;)if((r=d[u++])!=r)return!0}else for(;c>u;u++)if((t||u in d)&&d[u]===a)return t||u||0;return!t&&-1}}},function(t,e,a){var o=a(10),n=Math.min;t.exports=function(t){return t>0?n(o(t),9007199254740991):0}},function(t,e,a){var o=a(10),n=Math.max,s=Math.min;t.exports=function(t,e){return(t=o(t))<0?n(t+e,0):s(t,e)}},function(t,e,a){var o=a(47)(\"keys\"),n=a(49);t.exports=function(t){return o[t]||(o[t]=n(t))}},function(t,e,a){var o=a(2),n=a(1),s=n[\"__core-js_shared__\"]||(n[\"__core-js_shared__\"]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})(\"versions\",[]).push({version:o.version,mode:a(48)?\"pure\":\"global\",copyright:\"\\xa9 2019 Denis Pushkarev (zloirock.ru)\"})},function(t,e){t.exports=!0},function(t,e){var a=0,o=Math.random();t.exports=function(t){return\"Symbol(\".concat(void 0===t?\"\":t,\")_\",(++a+o).toString(36))}},function(t,e){t.exports=\"constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf\".split(\",\")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,a){var o=a(9);t.exports=function(t){return Object(o(t))}},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/inspection/partsInspection/index/index\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{producePartsList:[],index:0,partsCodes:[],partsItems:[],specification:1,number:0,partsStatus:!0,imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.loadProducePartsList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],partsCodes:[],partsItems:[]})},loadProducePartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/list/simple\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({producePartsList:e.data.data})}})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,partsCodes:[],partsItems:[]})},onScanTap:function(t){var e=this.data,a=e.partsCodes,o=e.producePartsList,n=e.index,s=e.partsItems,i=e.specification;e.number;if(a.indexOf(t)>-1)dd.showToast({type:\"fail\",content:this.data.producePartsList[n].name+\":\"+t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{a.push(t);var r={name:o[n].name,code:t};s.push(r),this.setData({partsCodes:a,partsItems:s,number:a.length*i})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.partsItems,n=a.partsCodes,s=a.specification;o.splice(e,1),n.splice(e,1),this.setData({partsItems:o,partsCodes:n,number:n.length*s})},specificationOnChange:function(t){var e=t.detail.value*this.data.partsCodes.length;this.setData({specification:t.detail.value,number:e})},partsStatusOnChange:function(t){this.setData({partsStatus:t.detail.value})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.producePartsList,n=a.index,s=a.partsCodes,r=(a.specification,a.number),d=a.partsStatus,c=a.imagePathList;if(0===s.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u6599\"}),null;var u={partsId:o[n].id,partsName:o[n].name,partsCodes:s.join(\",\"),partsStatus:d?0:1,specification:e.specification,number:r,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),c.length>0){var l=i.baseUrl+\"/api/file/upload/app\",p=c,g=u;this.uploadImage({url:l,filePath:p,options:g})}else this.producePartsInspectionApprove(u)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.producePartsInspectionApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},producePartsInspectionApprove:function(t){var e=i.baseUrl+\"/api/producePartsApprove\",a=this;dd.httpRequest({url:e,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u6765\\u6599\\u68c0\\u9a8c\\u5ba1\\u6279\\u5b9e\\u4f8b\\u53d1\\u9001\\u6210\\u529f\",success:function(){dd.reLaunch({url:\"/pages/main/inspection/index/index\"})}}):dd.showToast({content:t.data.msg})},complete:function(){a.setData({loading:!1,imagePathList:[],imagePath:[]})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockIn/stockIn\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:0,goodsCodes:[],goodsItems:[],position:null,number:0,partsList:[],componentList:[],productList:[],partsStatus:!0,imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){},onShow:function(){this.getPartsList(),this.getComponentList(),this.getProductList(),this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/producePartsWaitStockIn/List\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/afterInspection/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){console.log(JSON.stringify(e)),200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockInApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){var e=this.data,a=e.index,o=e.partsList,n=e.componentList,s=e.productList,i=null;if(0===a)for(var r=0;r<o.length;r++)o[r].id===t&&(i={id:o[r].id,name:o[r].name,specification:o[r].specification});else if(1===a)for(var d=0;d<n.length;d++)n[d].id===t&&(i={id:n[d].id,name:n[d].name,specification:1});else if(2===a)for(var c=0;c<s.length;c++)s[c].id===t&&(i={id:s[c].id,name:s[c].name,specification:1});else i=null;return i},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u4e0d\\u5408\\u683c\\u7684\\u7269\\u54c1\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null!==e.position){var u={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,position:e.position};if(this.setData({loading:!0}),s.length>0){var l=i.baseUrl+\"/api/file/upload/app\",p=s,g=u;this.uploadImage({url:l,filePath:p,options:g})}else this.produceStockInApprove(u)}else dd.alert({content:\"\\u672a\\u586b\\u5199\\u5b58\\u50a8\\u4f4d\\u7f6e\"})},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockInApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockInApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockIn/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u5165\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockOut/stockOut\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:0,goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getPartsList(),this.getComponentList(),this.getProductList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stock/in/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/stockIn/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockOutApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){var e=this.data,a=e.index,o=e.partsList,n=e.componentList,s=e.productList,i=null;switch(a){case 0:for(var r=0;r<o.length;r++)o[r].id===t&&(i={id:o[r].id,name:o[r].name,specification:o[r].specification});break;case 1:for(var d=0;d<n.length;d++)n[d].id===t&&(i={id:n[d].id,name:n[d].name,specification:1});break;case 2:for(var c=0;c<s.length;c++)s[c].id===t&&(i={id:s[c].id,name:s[c].name,specification:1})}return i},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u8be5\\u7269\\u54c1\\u4e0d\\u5728\\u5e93\\u5b58\\u4e2d\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null===e.receivePeople){var u=null;return u=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u4eba\\u5458\":\"\\u672a\\u586b\\u5199\\u9886\\u53d6\\u4eba\\u5458\",void dd.alert({content:u})}if(null===e.receiveAddress){var l=null;return l=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u5730\\u5740\":\"\\u672a\\u586b\\u5199\\u7269\\u6599\\u53bb\\u5411\",void dd.alert({content:l})}var p={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,receivePeople:e.receivePeople,receiveAddress:e.receiveAddress};if(this.setData({loading:!0}),s.length>0){var g=i.baseUrl+\"/api/file/upload/app\",m=s,h=p;this.uploadImage({url:g,filePath:m,options:h})}else this.produceStockOutApprove(p)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockOutApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockOutApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockOut/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u51fa\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/defendApprove/defendApprove\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getPartsList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],goodsCodes:[],goodsItems:[]})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stockOutWaittingDefend/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.partsList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:e[o].specification});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u51fa\\u5e93\\u7684\\u90e8\\u4ef6\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems;a.goodsList,a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;var d={typeName:r[0].name,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),s.length>0){var c=i.baseUrl+\"/api/file/upload/app\",u=s,l=d;this.uploadImage({url:c,filePath:u,options:l})}else this.producePartsDefend(d)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.producePartsDefend(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},producePartsDefend:function(t){var e=this,a=i.baseUrl+\"/api/producePartsDefend/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u4e09\\u9632\\u5904\\u7406\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/softInstallApprove/softInstallApprove\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getPartsList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stockOutUnSoftInstallParts/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.partsList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:e[o].specification});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u51fa\\u5e93\\u7684\\u90e8\\u4ef6\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList;a.goodsItems,a.goodsList,a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(\"\"===e.softVersion)return dd.alert({content:\"\\u672a\\u586b\\u5199\\u704c\\u88c5\\u8f6f\\u4ef6\\u7248\\u672c\\u53f7\"}),null;var r={codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,softVersion:e.softVersion};if(this.setData({loading:!0}),s.length>0){var d=i.baseUrl+\"/api/file/upload/app\",c=s,u=r;this.uploadImage({url:d,filePath:c,options:u})}else this.ProducePartsSoftInstall(r)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.ProducePartsSoftInstall(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},ProducePartsSoftInstall:function(t){var e=this,a=i.baseUrl+\"/api/producePartsSoftInstallApprove/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u8f6f\\u4ef6\\u704c\\u88c5\\u548c\\u8bbe\\u5907\\u6821\\u51c6\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/functionInspectionApprove/functionInspectionApprove\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{status:!0,goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getPartsList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],goodsCodes:[],goodsItems:[]})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stockOutUnFunctionInspectionParts/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.partsList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:e[o].specification});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u51fa\\u5e93\\u7684\\u90e8\\u4ef6\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},statusOnChange:function(){var t=this.data.status;this.setData({status:!t})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList;a.goodsItems,a.goodsList,a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;var r={codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),s.length>0){var d=i.baseUrl+\"/api/file/upload/app\",c=s,u=r;this.uploadImage({url:d,filePath:c,options:u})}else this.ProduceFunctionInspection(r)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.ProduceFunctionInspection(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},ProduceFunctionInspection:function(t){var e=this,a=i.baseUrl+\"/api/producePartsFunctionInspectionApprove/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u90e8\\u4ef6\\u529f\\u80fd\\u68c0\\u6d4b\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/componentProduce/componentProduce\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{componentList:[],index:0,goodsCodes:[],goodsItems:[],produceComponentList:[],componentStatus:!0,imagePathList:[],isFold:!1,isComponentFold:!1,imagePath:[],loading:!1},onLoad:function(){this.loadProducePartsList(),this.loadProduceComponentList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],goodsCodes:[],goodsItems:[],componentCodes:[],componentItems:[]})},loadProduceComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponentInfo/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({componentList:e.data.data})}})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],componentCodes:[],componentItems:[]})},loadProducePartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stockOutUnUsed/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({partsList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.partsList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:e[o].specification});return a},onScanPartsTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u51fa\\u5e93\\u7684\\u90e8\\u4ef6\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n})},onComponentScanTap:function(t){null===this.checkGoods(t)?this.setData({componentId:t}):dd.showToast({type:\"fail\",content:\"\\u626b\\u63cf\\u7684\\u662f\\u90e8\\u4ef6\\u7684\\u4e8c\\u7ef4\\u7801\\uff0c\\u8bf7\\u68c0\\u67e5!\"})},ComponentFoldTap:function(){var t=this.data.isComponentFold;this.setData({isComponentFold:!t})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.componentList,n=a.index,s=a.goodsCodes,r=a.componentId,d=a.imagePathList;if(0===s.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u90e8\\u4ef6\"}),null;if(!r)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7ec4\\u4ef6\"}),null;var c={id:r,componentId:o[n].id,componentName:o[n].name,partsCode:s.join(\",\"),produceOperator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,produceRemark:e.remark};if(this.setData({loading:!0}),d.length>0){var u=i.baseUrl+\"/api/file/upload/app\",l=d,p=c;this.uploadImage({url:u,filePath:l,options:p})}else this.componentProduce(c)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.produceImage=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.componentProduce(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},componentProduce:function(t){var e=i.baseUrl+\"/api/produceComponent/produce\",a=this;dd.httpRequest({url:e,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7ec4\\u4ef6\\u88c5\\u914d\\u5b8c\\u6bd5\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){a.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/componentProduceApprove/componentProduceApprove\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsCodes:[],goodsItems:[],number:0,componentList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getComponentList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],goodsCodes:[],goodsItems:[]})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/unProduceApproce/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.componentList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u88c5\\u914d\\u7684\\u7ec4\\u4ef6\"});a.push(t);var s={name:n.name,code:t};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;var d={name:r[0].name,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),s.length>0){var c=i.baseUrl+\"/api/file/upload/app\",u=s,l=d;this.uploadImage({url:c,filePath:u,options:l})}else this.ComponentProduceApprove(d)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.ComponentProduceApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},ComponentProduceApprove:function(t){var e=this,a=i.baseUrl+\"/api/produceComponent/produceApprove\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7ec4\\u4ef6\\u88c5\\u914d\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/productProduce/productProduce\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{productList:[],index:0,partsCodes:[],partsItems:[],partsList:[],componentCodes:[],componentItems:[],componentList:[],productCodes:[],productItems:[],imagePathList:[],isPartsFold:!1,isComponentFold:!1,isProductFold:!1,productId:null,imagePath:[],loading:!1},onLoad:function(){this.loadProduceProductList(),this.loadProducePartsList(),this.loadProduceComponentList()},onShow:function(){this.setData({imagePath:[],imagePathList:[],partsCodes:[],partsItems:[],componentCodes:[],componentItems:[],productCodes:[],productItems:[]})},loadProduceProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/productInfo/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({productList:e.data.data})}})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,partsCodes:[],partsItems:[],componentCodes:[],componentItems:[],productCodes:[],productItems:[]})},loadProducePartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stockOutUnUsed/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({partsList:e.data.data})}})},checkParts:function(t){for(var e=this.data.partsList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:e[o].specification});return a},onScanPartsTap:function(t){var e=this.data,a=e.partsCodes,o=e.partsItems;if(a.indexOf(t)>-1)dd.alert({content:\"\\u90e8\\u4ef6\"+t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkComponent(t);if(null!==n)return void dd.alert({content:\"\\u626b\\u63cf\\u7684\\u662f\\u7ec4\\u4ef6\\u7684\\u4e8c\\u7ef4\\u7801\\uff0c\\u8bf7\\u68c0\\u67e5\\uff01\"});if(null===(n=this.checkParts(t)))return void dd.alert({content:\"\\u672a\\u51fa\\u5e93\\u7684\\u90e8\\u4ef6\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({partsCodes:a,partsItems:o})}},partsFoldTap:function(){var t=this.data.isPartsFold;this.setData({isPartsFold:!t})},cancelPartsItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.partsItems,n=a.partsCodes;o.splice(e,1),n.splice(e,1),this.setData({partsItems:o,partsCodes:n})},loadProduceComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/afterInspectionUnuse/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){0===e.data.code&&t.setData({componentList:e.data.data})}})},checkComponent:function(t){for(var e=this.data.componentList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:1});return a},onComponentScanTap:function(t){var e=this.data,a=e.componentCodes,o=e.componentItems;if(a.indexOf(t)>-1)dd.alert({content:\"\\u7ec4\\u4ef6\"+t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkParts(t);if(null===n)if(null!==(n=this.checkComponent(t))){a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({componentCodes:a,componentItems:o})}else dd.alert({content:\"\\u672a\\u68c0\\u9a8c\\u5408\\u683c\\u7684\\u7ec4\\u4ef6\"});else dd.alert({content:\"\\u626b\\u63cf\\u7684\\u662f\\u90e8\\u4ef6\\u7684\\u4e8c\\u7ef4\\u7801\\uff0c\\u8bf7\\u68c0\\u67e5\\uff01\"})}},componentFoldTap:function(){var t=this.data.isComponentFold;this.setData({isComponentFold:!t})},cancelComponentItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.componentItems,n=a.componentCodes;o.splice(e,1),n.splice(e,1),this.setData({componentItems:o,componentCodes:n})},onProductScanTap:function(t){var e=this.checkParts(t);null===e?null==(e=this.checkComponent(t))?this.setData({productId:t}):dd.alert({content:\"\\u626b\\u63cf\\u7684\\u662f\\u7ec4\\u4ef6\\u7684\\u4e8c\\u7ef4\\u7801\\uff0c\\u8bf7\\u68c0\\u67e5\\uff01\"}):dd.alert({content:\"\\u626b\\u63cf\\u7684\\u662f\\u90e8\\u4ef6\\u7684\\u4e8c\\u7ef4\\u7801\\uff0c\\u8bf7\\u68c0\\u67e5\\uff01\"})},productFoldTap:function(){var t=this.data.isProductFold;this.setData({isProductFold:!t})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.productList,n=a.index,s=a.partsCodes,r=a.componentCodes,d=a.productId,c=a.imagePathList;if(!d)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u4ea7\\u54c1\\u7f16\\u53f7\"}),null;0===s.length&&0===r.length&&dd.alert({content:\"\\u81f3\\u5c11\\u9009\\u62e9\\u4e00\\u4e2a\\u90e8\\u4ef6\\u6216\\u7ec4\\u4ef6\"});var u={id:d,productId:o[n].id,productName:o[n].name,partsCode:s.join(\",\"),componentCode:r.join(\",\"),userId:i.user.userId,deptId:i.user.deptId,produceOperator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,produceRemark:e.remark};if(this.setData({loading:!0}),c.length>0){var l=i.baseUrl+\"/api/file/upload/app\",p=c,g=u;this.uploadImage({url:l,filePath:p,options:g})}else this.productProduce(u)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.produceImage=a.data.imagePath.join(\";\"),a.productProduce(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},productProduce:function(t){console.log(t);var e=i.baseUrl+\"/api/produce/product/produce\",a=this;dd.httpRequest({url:e,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u4ea7\\u54c1\\u88c5\\u914d\\u5b8c\\u6bd5\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){a.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/produce/productProduceApprove/productProduceApprove\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsCodes:[],goodsItems:[],number:0,productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getProductList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingProduceApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.productList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:\"\\u4ea7\\u54c1\"+t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u88c5\\u914d\\u7684\\u4ea7\\u54c1\"});a.push(t);var s={name:n.name,code:t};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u4ea7\\u54c1\"}),null;var d={productName:r[0].name,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),s.length>0){var c=i.baseUrl+\"/api/file/upload/app\",u=s,l=d;this.uploadImage({url:c,filePath:u,options:l})}else this.productProduceApprove(d)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.productProduceApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},productProduceApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/product/produce/approve\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u4ea7\\u54c1\\u88c5\\u914d\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/inspection/productInspection/productInspection\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsCodes:[],goodsItems:[],number:0,productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1,status:!0},onLoad:function(){this.loadProductList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},loadProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingInspectionApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){console.log(e.data),0===e.data.code&&t.setData({productList:e.data.data})}})},checkGoods:function(t){var e=this.data.productList;console.log(t);for(var a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:\"\\u4ea7\\u54c1\"+t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u672a\\u88c5\\u914d\\u7684\\u4ea7\\u54c1\"});a.push(t);var s={name:n.name,code:t};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},productStatusOnChange:function(t){this.setData({status:t.detail.value})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.status;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u4ea7\\u54c1\"}),null;var c={productName:r[0].name,codes:o.join(\",\"),number:n,status:d?0:1,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark};if(this.setData({loading:!0}),s.length>0){var u=i.baseUrl+\"/api/file/upload/app\",l=s,p=c;this.uploadImage({url:u,filePath:l,options:p})}else this.productInspectionApprove(c)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.productInspectionApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},productInspectionApprove:function(t){var e=i.baseUrl+\"/api/produce/product/inspection/approve\",a=this;dd.httpRequest({url:e,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u4ea7\\u54c1\\u68c0\\u9a8c\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){a.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockInParts/stockInParts\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:0,goodsCodes:[],goodsItems:[],position:null,number:0,partsList:[],componentList:[],productList:[],partsStatus:!0,imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){},onShow:function(){this.getPartsList(),this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/producePartsWaitStockIn/List\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/afterInspection/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockInApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data,a=(e.index,e.partsList),o=null,n=0;n<a.length;n++)a[n].id===t&&(o={id:a[n].id,name:a[n].name,specification:a[n].specification});return o},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u4e0d\\u5408\\u683c\\u7684\\u7269\\u54c1\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null!==e.position){var u={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,position:e.position};if(this.setData({loading:!0}),s.length>0){var l=i.baseUrl+\"/api/file/upload/app\",p=s,g=u;this.uploadImage({url:l,filePath:p,options:g})}else this.produceStockInApprove(u)}else dd.alert({content:\"\\u672a\\u586b\\u5199\\u5b58\\u50a8\\u4f4d\\u7f6e\"})},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockInApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockInApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockIn/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u5165\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockInComponent/stockInComponent\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:1,goodsCodes:[],goodsItems:[],position:null,number:0,partsList:[],componentList:[],productList:[],partsStatus:!0,imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getComponentList()},onShow:function(){this.getComponentList(),this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/producePartsWaitStockIn/List\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/afterInspection/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockInApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data,a=(e.index,e.componentList),o=null,n=0;n<a.length;n++)a[n].id===t&&(o={id:a[n].id,name:a[n].name,specification:1});return o},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u4e0d\\u5408\\u683c\\u7684\\u7269\\u54c1\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null!==e.position){var u={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,position:e.position};if(this.setData({loading:!0}),s.length>0){var l=i.baseUrl+\"/api/file/upload/app\",p=s,g=u;this.uploadImage({url:l,filePath:p,options:g})}else this.produceStockInApprove(u)}else dd.alert({content:\"\\u672a\\u586b\\u5199\\u5b58\\u50a8\\u4f4d\\u7f6e\"})},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockInApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockInApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockIn/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u5165\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockInProduct/stockInProduct\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:2,goodsCodes:[],goodsItems:[],position:null,number:0,partsList:[],componentList:[],productList:[],partsStatus:!0,imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getProductList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/producePartsWaitStockIn/List\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/afterInspection/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockInApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.productList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:1});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u4e0d\\u5408\\u683c\\u7684\\u7269\\u54c1\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null!==e.position){var u={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,position:e.position};if(this.setData({loading:!0}),s.length>0){var l=i.baseUrl+\"/api/file/upload/app\",p=s,g=u;this.uploadImage({url:l,filePath:p,options:g})}else this.produceStockInApprove(u)}else dd.alert({content:\"\\u672a\\u586b\\u5199\\u5b58\\u50a8\\u4f4d\\u7f6e\"})},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockInApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockInApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockIn/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u5165\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockOutParts/stockOutParts\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:0,goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getPartsList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stock/in/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/stockIn/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockOutApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.partsList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:e[o].specification});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u8be5\\u7269\\u54c1\\u4e0d\\u5728\\u5e93\\u5b58\\u4e2d\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null===e.receivePeople){var u=null;return u=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u4eba\\u5458\":\"\\u672a\\u586b\\u5199\\u9886\\u53d6\\u4eba\\u5458\",void dd.alert({content:u})}if(null===e.receiveAddress){var l=null;return l=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u5730\\u5740\":\"\\u672a\\u586b\\u5199\\u7269\\u6599\\u53bb\\u5411\",void dd.alert({content:l})}var p={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,receivePeople:e.receivePeople,receiveAddress:e.receiveAddress};if(this.setData({loading:!0}),s.length>0){var g=i.baseUrl+\"/api/file/upload/app\",m=s,h=p;this.uploadImage({url:g,filePath:m,options:h})}else this.produceStockOutApprove(p)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockOutApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockOutApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockOut/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u51fa\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockOutProduct/stockOutProduct\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:2,goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getProductList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stock/in/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/stockIn/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockOutApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.productList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:1});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u8be5\\u7269\\u54c1\\u4e0d\\u5728\\u5e93\\u5b58\\u4e2d\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null===e.receivePeople){var u=null;return u=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u4eba\\u5458\":\"\\u672a\\u586b\\u5199\\u9886\\u53d6\\u4eba\\u5458\",void dd.alert({content:u})}if(null===e.receiveAddress){var l=null;return l=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u5730\\u5740\":\"\\u672a\\u586b\\u5199\\u7269\\u6599\\u53bb\\u5411\",void dd.alert({content:l})}var p={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,receivePeople:e.receivePeople,receiveAddress:e.receiveAddress};if(this.setData({loading:!0}),s.length>0){var g=i.baseUrl+\"/api/file/upload/app\",m=s,h=p;this.uploadImage({url:g,filePath:m,options:h})}else this.produceStockOutApprove(p)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockOutApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockOutApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockOut/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u51fa\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";var o,n=a(0),s=(o=n)&&o.__esModule?o:{default:o};$global.currentPageConfig={pagePath:\"pages/main/stock/stockOutComponent/stockOutComponent\",usingComponents:{scan:\"/components/scan/scan\",list:\"/node_modules/mini-ddui/es/list/index\",\"list-item\":\"/node_modules/mini-ddui/es/list/list-item/index\"}};var i=getApp().globalData;Page({data:{goodsList:[{name:\"\\u90e8\\u4ef6\",value:0},{name:\"\\u7ec4\\u4ef6\",value:1},{name:\"\\u4ea7\\u54c1\",value:2}],index:1,goodsCodes:[],goodsItems:[],receivePeople:null,receiveAddress:null,number:0,partsList:[],componentList:[],productList:[],imagePathList:[],isFold:!1,imagePath:[],loading:!1},onLoad:function(){this.getComponentList()},onShow:function(){this.setData({goodsCodes:[],goodsItems:[],imagePath:[],imagePathList:[]})},bindPickerChange:function(t){var e=t.detail.value;this.setData({index:e,goodsCodes:[],goodsItems:[],number:0})},getPartsList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceParts/stock/in/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({partsList:e.data.data})}})},getComponentList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produceComponent/stockIn/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({componentList:e.data.data})}})},getProductList:function(){var t=this;dd.httpRequest({url:i.baseUrl+\"/api/produce/product/waittingStockOutApprove/list\",headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(e){200===e.status&&t.setData({productList:e.data.data})}})},checkGoods:function(t){for(var e=this.data.componentList,a=null,o=0;o<e.length;o++)e[o].id===t&&(a={id:e[o].id,name:e[o].name,specification:1});return a},onScanTap:function(t){var e=this.data,a=e.goodsCodes,o=e.goodsItems;if(a.indexOf(t)>-1)dd.alert({content:t+\"\\u5df2\\u5b58\\u5728\\uff0c\\u8bf7\\u52ff\\u91cd\\u590d\\u626b\\u63cf!\"});else{var n=this.checkGoods(t);if(null===n)return void dd.alert({content:\"\\u8be5\\u7269\\u54c1\\u4e0d\\u5728\\u5e93\\u5b58\\u4e2d\"});a.push(t);var s={name:n.name,code:t,specification:n.specification};o.push(s),this.setData({goodsCodes:a,goodsItems:o,number:a.length*n.specification})}},foldTap:function(){var t=this.data.isFold;this.setData({isFold:!t})},cancelItemTap:function(t){var e=t.currentTarget.dataset.index,a=this.data,o=a.goodsItems,n=a.goodsCodes;o.splice(e,1),n.splice(e,1),this.setData({goodsItems:o,goodsCodes:n,number:n.length})},chooseImageTap:function(){var t=this;dd.chooseImage({count:5,success:function(e){var a=t.data.imagePathList;e.apFilePaths.map(function(t){return a.push(t)}),t.setData({imagePathList:a})}})},imageTap:function(t){var e=t.currentTarget.dataset.index,a=this;dd.confirm({title:\"\\u6e29\\u99a8\\u63d0\\u793a\",content:\"\\u60a8\\u662f\\u5426\\u60f3\\u5220\\u9664\\u6240\\u9009\\u7684\\u56fe\\u7247\",confirmButtonText:\"\\u9a6c\\u4e0a\\u5220\\u9664\",cancelButtonText:\"\\u6682\\u4e0d\\u9700\\u8981\",success:function(t){if(t.confirm){var o=a.data.imagePathList;o.splice(e,1),a.setData({imagePathList:o})}}})},previewImage:function(t){var e=t.currentTarget.dataset.index,a=this.data.imagePathList;dd.previewImage({current:e,urls:a[e].split(\",\")})},onSubmitTap:function(t){var e=t.detail.value,a=this.data,o=a.goodsCodes,n=a.number,s=a.imagePathList,r=a.goodsItems,d=a.goodsList,c=a.index;if(0===o.length)return dd.alert({content:\"\\u672a\\u626b\\u63cf\\u7269\\u54c1\"}),null;if(null===e.receivePeople){var u=null;return u=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u4eba\\u5458\":\"\\u672a\\u586b\\u5199\\u9886\\u53d6\\u4eba\\u5458\",void dd.alert({content:u})}if(null===e.receiveAddress){var l=null;return l=2===c?\"\\u672a\\u586b\\u5199\\u6536\\u8d27\\u5730\\u5740\":\"\\u672a\\u586b\\u5199\\u7269\\u6599\\u53bb\\u5411\",void dd.alert({content:l})}var p={typeName:r[0].name,goodsType:d[c].value,codes:o.join(\",\"),number:n,userId:i.user.userId,deptId:i.user.deptId,operator:dd.getStorageSync({key:\"userInfo\"}).data.user.username,remark:e.remark,receivePeople:e.receivePeople,receiveAddress:e.receiveAddress};if(this.setData({loading:!0}),s.length>0){var g=i.baseUrl+\"/api/file/upload/app\",m=s,h=p;this.uploadImage({url:g,filePath:m,options:h})}else this.produceStockOutApprove(p)},uploadImage:function(t){var e=t.i?t.i:0,a=this;dd.uploadFile({url:t.url,filePath:t.filePath[e],fileName:\"file\",fileType:\"image\",header:{\"content-type\":\"\"},success:function(o){if(200===o.statusCode){var n=JSON.parse(o.data),s=a.data.imagePath;if(s.push(n.data),a.setData({imagePath:s}),e===t.filePath.length-1){var i=t.options;i.image=a.data.imagePath.join(\";\"),console.log(JSON.stringify(i)),a.produceStockOutApprove(i)}else e++,t.i=e,a.uploadImage(t)}else console.log(\"\\u6587\\u4ef6\\u4e0a\\u4f20\\u5931\\u8d25\")}})},produceStockOutApprove:function(t){var e=this,a=i.baseUrl+\"/api/produce/stockOut/add\";dd.httpRequest({url:a,method:\"POST\",data:(0,s.default)({},t),headers:{Authorization:dd.getStorageSync({key:\"userInfo\"}).data.token},success:function(t){0===t.data.code?dd.showToast({content:\"\\u7269\\u54c1\\u51fa\\u5e93\\u5ba1\\u6279\\u63d0\\u4ea4\\u6210\\u529f\",success:function(){dd.navigateBack({delta:1})}}):dd.showToast({content:t.data.msg})},complete:function(){e.setData({loading:!1})}})}})},function(t,e,a){\"use strict\";(function(t){(\"undefined\"!==typeof t?t:self).appXAppJson={app:{$homepage:\"pages/main/index/index\"}}}).call(this,a(72))},function(t,e){var a;a=function(){return this}();try{a=a||new Function(\"return this\")()}catch(t){\"object\"===typeof window&&(a=window)}t.exports=a},function(t,e,a){\"use strict\";self.Map&&self.Set||importScripts(\"https://gw.alipayobjects.com/as/g/appx_release/deps/1.0.0/es6-set-map.js\"),importScripts(\"https://appx/af-appx.worker.min.js\")}]);","extractedComments":[]}